Report for Lab4
计34 茹逸中 2013011375

**练习1：**

1.理解分析sched_class中各函数指针的用法，描述ucore的调度执行过程。

(1)init

初始化等待队列，在操作系统启动后需要执行一次，然后才能开始进程调度工作。

(2)enqueue

将一个进程入队。在进程从其他状态进入就绪状态时会执行这个函数，表示该进程需要进行调度。

(3)dequeue

将一个进程出队。转入运行态的进程会出队，被杀死的进程也会出队。

(4)pick_next

操作系统根据具体的调度算法决定将队列中的一个进程转入运行态。

(5)proc_tick

时钟中断触发时需要将程序剩余的时间片减一，在进程的时间片用完时进程就需要重新被调度了。

ucore的调度执行过程：

在CPU执行到内核抢占点或者一个进程的时间片用完时，会触发中断，这时操作系统会将正在运行的进程打断并加入就绪队列。操作系统会根据调度算法选出队列中的一个其它进程继续运行。

2.多级反馈队列调度算法

假设有N个队列，第i个队列的进程将获得的时间片数量为Ti

(1)进程创建

进程创建时指定优先级为1（最高级），设定当前优先级已运行的时间片数量为0。

(1)init

将所有队列初始化为空

(2)enqueue

将进程加入其优先级对应的队列中

(3)dequeue

将进程出队

(4)pick_next

找到所有非空的队列中优先级最高的队列，找到第一个入队的进程，将其当前优先级运行的时间片数量加一，若当前优先级的时间片已用完，则优先级加一，时间片清零。

**练习2：**

实现过程：

(1)init

情况链表，并初始化一些变量。

(2)enqueue

将进程加入相应的数据结构。并设置进程运行的时间片。

(3)dequeue

将进程从相应的数据结构中删除。

(4)pick_next

从相应数据结构中找出stride最小的进程。堆只需要取堆顶元素，而链表需要遍历找最小值。找到进程后需要将该进程的stride值加上步长，步长的计算方法为BIG_STRIDE / priority。当优先级为0时加上BIG_STRIDE。


