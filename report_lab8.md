8Report for Lab7
计34 茹逸中 2013011375

**练习1：**实现sfs_io_nolock函数。

实现方法：先打开文件。打开文件时需要先处理开头没有块对齐的部分，然后处理中间的若干个块，最后处理结尾的剩余部分。每次调用sfs_bmap_load_nolock获得inode编号，在读取整块时调用sfs_rblock，在开头和结尾读取一部分时调用sfs_rbuf。

**pipe机制的实现**

可以借用文件系统实现管道机制。在用户需要使用管道机制时，创建一个新的inode，这个inode中的所有数据都存放在内存中。输出进程打开一个文件，权限为可写，这个文件的inode为新建的inode。输入进程打开一个文件，权限为只读，这个文件的inode也为新建的inode。这样就实现了管道机制。


**练习2：**修改fork函数使其可以适应文件系统的要求。

需要修改proc.c

1. 在初始化时，需要将proc->filesp 置为 NULL

2. 在do_fork中，需要复制filesp

3. 完善load_icode函数，需要为创建新进程建立mm和PDT，然后调用load_icode_read函数载入elf文件，然后分配内存和堆栈，最后设置trapframe。

**软链接和硬链接

软链接：软链接即快捷方式。新增一种文件类型为快捷方式，该文件仅保存了指向的文件所在的位置。在打开快捷方式时，打开快捷方式指向的文件。

硬链接：在inode中记录该inode被引用的次数。多个文件可以指向同一个inode。如果删除了一个文件，则inode中引用次数减一。只用被减到0之后该inode及其对应的数据才被删除。

